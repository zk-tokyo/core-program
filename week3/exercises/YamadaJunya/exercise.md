## 1. SNARK とは … ARgument of Knowledge（p.7）を指しますが、なぜ「証明」であるのに “argument” と表現しているのでしょうか？ ”proof” と “argument” の違いを調べて説明してみましょう。

SNARK の “argument” は、証明の正しさが計算量制限に依存する「計算的証明」を意味する。Proof は計算能力無制限でも成立する絶対的保証だが、Argument は有限計算力の前提でのみ成立する。SNARK は暗号的困難性を前提にしているため “proof” ではなく “argument” と呼ばれる。

---

## 2. p.21のKZGにおいて、コミットメントに秘匿性（i.e., ゼロ知識性）を与えるにはどうすれば良いでしょうか？具体的な構築方法を調べて説明してみましょう。

KZGにゼロ知識性を与えるには、ランダム性を混ぜる仕組みを導入する。  
具体的には、通常の基底 $g_1$ とは独立な基底 $h_1$ を追加し、  
多項式 $f(X)$ に加えて乱数多項式 $r(X)$ を同時にコミットする。

コミットは次の形になる：  
$C = g_1^{f(\tau)} \cdot h_1^{r(\tau)}$

---

## 3. f(a, b) = 5 * (a * b - a) + 2 * b を PLONK が適用できる形（i.e., 複数の一変量多項式）に途中経過をわかりやすく明示しながら変換してみましょう。

$$
f(a, b) = 5 \cdot (a \cdot b - a) + 2 \cdot b
$$
を、PLONK の「1ゲート=1行」な制約
$$
q_L \cdot l + q_R \cdot r + q_M \cdot (l \cdot r) + q_O \cdot o + q_C = 0
$$
の形に分解し、複数の一変量多項式として定義する。

---

#### 1) 算術回路への分解

$$
\begin{aligned}
t_1 &= a \cdot b \\
t_2 &= t_1 - a \\
t_3 &= 5 \cdot t_2 \\
t_4 &= 2 \cdot b \\
y   &= t_3 + t_4
\end{aligned}
$$

各行（ゲート）で $(L, R, O)$ を次のように割当：

| 行 i | 意味               | L     | R   | O   |
|-----:|--------------------|-------|-----|-----|
| 0    | 乗算                | a     | b   | t₁  |
| 1    | 減算                | t₁    | a   | t₂  |
| 2    | 5 倍（線形）        | t₂    | 0   | t₃  |
| 3    | 2 倍（線形）        | b     | 0   | t₄  |
| 4    | 加算                | t₃    | t₄  | y   |

---

#### 2) セレクタ（ゲート制約）$q_L, q_R, q_M, q_O, q_C$ の割当
各行の等式が
$$
q_L \cdot l + q_R \cdot r + q_M \cdot (l \cdot r) + q_O \cdot o + q_C = 0
$$
になるように係数を置く：

- 行0（$t_1 = a \cdot b$）:  $$0 \cdot l + 0 \cdot r + 1 \cdot (l \cdot r) - o = 0$$
- 行1（$t_2 = t_1 - a$）: $$1 \cdot l - r - o = 0$$
- 行2（$t_3 = 5 \cdot t_2$）: $$5 \cdot l - o = 0$$
- 行3（$t_4 = 2 \cdot b$）: $$2 \cdot l - o = 0$$
- 行4（$y = t_3 + t_4$）: $$l + r - o = 0$$

よって評価表（行ごとの値）は：

| 行 i | qL | qR | qM | qO | qC |
|-----:|---:|---:|---:|---:|---:|
| 0    |  0 |  0 |  1 | -1 |  0 |
| 1    |  1 | -1 |  0 | -1 |  0 |
| 2    |  5 |  0 |  0 | -1 |  0 |
| 3    |  2 |  0 |  0 | -1 |  0 |
| 4    |  1 |  1 |  0 | -1 |  0 |

---

#### 3) 評価ドメインと「一変量多項式」化
ゲート数 $n=5$。位数 $n$ の 1 の原始根 $\omega$ を取り、評価ドメイン
$$
H = \{1, \omega, \omega^2, \omega^3, \omega^4\}
$$
を用いる。

- **セレクタ多項式**  
  $q_L(X), q_R(X), q_M(X), q_O(X), q_C(X)$ を、上表の行 $i$ の値を
  それぞれ点 $X = \omega^i$ における評価値として **ラグランジュ補間**で一意に定義する。
  例：$q_L(\omega^0)=0, q_L(\omega^1)=1, q_L(\omega^2)=5, q_L(\omega^3)=2, q_L(\omega^4)=1$ など。

- **ウィットネス多項式**  
  $L(X), R(X), O(X)$ も同様に、各行の $(L, R, O)$ 値を $H$ 上の評価として定義する：
  $$
  \begin{aligned}
  &L(\omega^0)=a, \quad R(\omega^0)=b, \quad O(\omega^0)=t_1 \\
  &L(\omega^1)=t_1, \quad R(\omega^1)=a, \quad O(\omega^1)=t_2 \\
  &L(\omega^2)=t_2, \quad R(\omega^2)=0, \quad O(\omega^2)=t_3 \\
  &L(\omega^3)=b, \quad R(\omega^3)=0, \quad O(\omega^3)=t_4 \\
  &L(\omega^4)=t_3, \quad R(\omega^4)=t_4, \quad O(\omega^4)=y
  \end{aligned}
  $$

---

#### 4) コピー制約（順列）
同じ値が複数の位置に現れる（配線）ことを **順列多項式**で表す。  
列 $(L,R,O)$ を縦に連結し、全体のグローバルインデックスを

- L 列：$0..4$
- R 列：$5..9$
- O 列：$10..14$

とする（$i$ は行番号）。

等価関係：
$$
\begin{aligned}
t_1 &: O_0(=10) \leftrightarrow L_1(=1) \\
t_2 &: O_1(=11) \leftrightarrow L_2(=2) \\
t_3 &: O_2(=12) \leftrightarrow L_4(=4) \\
t_4 &: O_3(=13) \leftrightarrow R_4(=9) \\
a   &: L_0(=0)  \leftrightarrow R_1(=6) \\
b   &: R_0(=5)  \leftrightarrow L_3(=3)
\end{aligned}
$$

よって
| gate     | $\sigma_L$        | $\sigma_R$        | $\sigma_O$        |
|----------|------------------|------------------|------------------|
| gate#0   | $\omega^0 k_0$   | $\omega^1 k_1$   | $\omega^0 k_2$   |
| gate#1   | $\omega^0 k_2$   | $\omega^0 k_0$   | $\omega^1 k_0$   |
| gate#2   | $\omega^0 k_1$   | $\omega^2 k_1$   | $\omega^2 k_2$   |
| gate#3   | $\omega^1 k_2$   | $\omega^2 k_0$   | $\omega^3 k_1$   |
| gate#4   | $\omega^2 k_0$   | $\omega^3 k_2$   | $\omega^4 k_0$   |


---

#### 5) PLONK に渡す多項式
最終的に、PLONK が扱う「複数の一変量多項式」は：

- セレクタ：$q_L(X), q_R(X), q_M(X), q_O(X), q_C(X)$
- ウィットネス：$L(X), R(X), O(X)$
- 順列（配線）：$\sigma_L(X), \sigma_R(X), \sigma_O(X)$ 


---

## 4. p.52におけるパブリックインプット・アウトプットの証明をたった1つのKZG評価証明で行うにはどうすれば良いか、調べて説明してみましょう。 → ヒント: ゼロテスト（p.53~p.54）を用いる。

パブリックインプットとアウトプットをまとめて1つのKZG評価証明で検証するには、ゼロテストの手法を用いる。  

具体的には、インプットとアウトプットを多項式にまとめ、その差をとった多項式 $h(X)$ を構成する。もし全ての点で一致していれば、$h(X)$ は検証したい集合に対応する多項式 $Z(X)$（ゼロテスト多項式）で割り切れる。すなわち、

$$
h(X) = Z(X) \cdot q(X)
$$

が成り立つ。  

このとき、証明者は商多項式 $q(X)$ のKZGコミットメントを提示し、検証者は 1点評価のKZG証明を確認するだけで「差がゼロである」ことを証明できる。  

