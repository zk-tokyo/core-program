# week 4 事前課題

yamdan

## 1. STARKにおいては、多項式に関する低次元テスト（LDT, p.39）が必要ですが、これまでみてきたSNARKでは不要でした。なぜSTARKではLDTが必要で、Groth16とPLONKではそれぞれ不要なのかを数式をまじえて説明してみましょう。

SNARKでもSTARKでも、
ある多項式 $f(X)$ が全ての点 $x \in \mathbb{F}_p$ で $f(x) = 0$ となることを証明する場面が現れる。

このとき全ての点でゼロになることを愚直に確認するのは非効率なので、
代わりにランダムに選んだ一点 $r \in \mathbb{F}_p$ だけで $f(r) = 0$ となることを確認し、
もしそうなら $f$ は全ての点でゼロになるとみなしてしまう方法が取られる。

このようなランダムサンプリングをしても問題にならないのは、
$f$ の次数 $d$ が定義域のサイズ $p$ よりもはるかに小さい場合に
Scwartz-Zippel の補題が成り立つおかげである。

Scwartz-Zippel の補題は、
多項式 $f$ の次数が高々 $d$ のとき、
ランダムに選んだ点 $x \in \mathbb{F}_p$ で $f(x) = 0$ となるなら、
$f$ は $1 - d / p$ 以上の確率でゼロ多項式である (全ての $x$ でゼロとなる)、
というものである。

$d$ が $p$ よりもはるかに小さければ、この確率は $1$ に極めて近く、
結果 $f$ は全ての点でゼロになるとなるとみなすことができる。
一方、$d$ が大きくなり $p$ に近付くほどこの確率は小さくなり、
ランダムサンプリングの正当性が得られなくなる。
なので $d$ が小さいこと = $f$ が低次であることを保証する必要がある。

Groth16やPLONKでは
Trusted Setupで作られるパラメータ
$G, \tau \cdot G, \tau^2 \cdot G, \ldots, \tau^d \cdot G$
を使って多項式 $f$ (のコミットメント)が表現される。
したがって $f$ の次数はあらかじめパラメータとして用意された $d$ を越えられず、
この $d$ が小さいサイズに設定されていれば $f$ の次数も低くなることが保証される。
(仮に $d$ を大きくするとパラメータサイズも大きくなり実行不能になる)

一方STARKの場合、多項式のコミットメントはMerkle Treeで表現されるが、
Merkle Treeは多項式の評価点の列にコミットをするだけで、
その次数に関しては制約が加えられていない。
そこでコミットメントとは別に低次元テスト(LDT)を行う必要が生じる。

## 2. スライドで説明されている構築方法では、STARKにゼロ知識性が付与されていません。STARKをzkSTARKに変換する方法を1つ取り上げ、なぜその方法がゼロ知識性を付与するのかを数式ベースで説明してみましょう。

実行トレースの多項式 $P(X)$ に、
ランダム多項式 $R(X)$ と
消失多項式 $Z(X) := X^T - 1$ の積を加えた
$$P'(X) := P(X) + R(X) Z(X)$$
を、マスクされた新たなトレース多項式として定義する。

その上で、遷移制約多項式と境界制約多項式は $P(X)$ の代わりに $P'(X)$ を使って定義する。

$P'(X)$ は評価点集合
$H = \{\omega^0, \omega^1, \ldots, \omega^{T-1}\}$
では $P(X)$ と同じ値をとるため、
元々の遷移制約と境界制約はそのまま保存される
(完全性と健全性には影響を与えない)。

一方、拡大領域 $G' = G \setminus H$ では
ランダムな値をとるようになるので、
プロトコルの途中で検証者に与えられる $P'(x)$ ($x \in G'$)
は元のトレースの値 $P(x)$ と独立になり、
結果としてゼロ知識性の付与に繋がる。

(加えてLDTにおける情報漏洩に関する手当ても必要？)
