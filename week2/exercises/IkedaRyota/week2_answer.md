## 1. QAPのトレースがなぜ加算ゲートの出力を記録しなくてもいいのか、理由を説明してください。（ヒント: Linear PCP）

加算の出力は線形なので、係数を足した線形問い合わせでその場で取り出せるため、witnessに新しい変数を作る必要がない。
一方、乗算は非線形で Linear PCP は線形結合しか読めないため、乗算結果は独立の変数としてwitnessに入れ、線形×線形＝線形で縛る必要がある。

---

## 2. 講義で紹介された算術回路とセレクター多項式をもとにマスター多項式p(x)と商多項式q(x)を一つ考えてください。

講義資料にあるセレクタ多項式($F_7, ω=2$)を用いて具体的な$p(x)$と$q(x)$を1組作成する。

### フィールドと評価点
体：$F_7$（係数は $\bmod 7$）
$$
\{\omega,\ \omega^2,\ \omega^3\}=\{2,4,1\},\qquad \omega^3 \equiv 1 \pmod 7.
$$

### 回路の witness(仮定)
$$
w_1=2,\quad w_2=2,\quad w_3=2,\quad w_4=2,\quad w_5=2,\quad w_6=2 \pmod 7.
$$

#### 中間値
$$
g_1 = w_1 w_2 = 2\cdot 2 = 4 \pmod 7
$$

$$
g_4 = g_1\,(w_3+w_4) = 4\cdot(2+2)=16\equiv 2 \pmod 7
$$

$$
g_5 = (w_3+w_4)(w_5+w_6)=(2+2)(2+2)=16 \equiv 2 \pmod 7
$$

#### witness ベクトル
$$
\mathbf{c}=(w_1,w_2,w_3,w_4,w_5,w_6,g_1,g_4,g_5)=(2,2,2,2,2,2,4,2,2)
$$

---

### セレクター多項式（講義資料）

**左入力**
- $l_{w_1}=3x^2+6x+5$  
- $l_{w_3}=l_{w_4}=5x^2+5x+5$  
- $l_{g_1}=6x^2+3x+5$  

**右入力**
- $r_{w_2}=3x^2+6x+5$  
- $r_{w_3}=r_{w_4}=6x^2+3x+5$  
- $r_{w_5}=r_{w_6}=5x^2+5x+5$  

**出力**
- $o_{g_1}=3x^2+6x+5$  
- $o_{g_4}=6x^2+3x+5$  
- $o_{g_5}=5x^2+5x+5$  

#### $L(x)=\sum_i c_i\,l_i(x)$
$$
L(x)=w_1l_{w_1}+w_3l_{w_3}+w_4l_{w_4}+g_1l_{g_1}
$$

代入：
$$
L(x)=2(3x^2+6x+5)+2(5x^2+5x+5)+2(5x^2+5x+5)+4(6x^2+3x+5)
$$

各スカラー倍：
$$
2(3x^2+6x+5)\equiv 6x^2+5x+3
$$
$$
2(5x^2+5x+5)\equiv 3x^2+3x+3
$$
$$
2(5x^2+5x+5)\equiv 3x^2+3x+3
$$
$$
4(6x^2+3x+5)\equiv 3x^2+5x+6
$$

和：
$$
L(x)\equiv x^2+2x+1 \pmod 7
$$

---

#### $R(x)=\sum_i c_i\,r_i(x)$
$$
R(x)=2(3x^2+6x+5)+2(6x^2+3x+5)+2(6x^2+3x+5)+2(5x^2+5x+5)+2(5x^2+5x+5)
$$

各スカラー倍：
$$
2(3x^2+6x+5)\equiv 6x^2+5x+3
$$
$$
2(6x^2+3x+5)\equiv 5x^2+6x+3
$$
$$
2(6x^2+3x+5)\equiv 5x^2+6x+3
$$
$$
2(5x^2+5x+5)\equiv 3x^2+3x+3
$$
$$
2(5x^2+5x+5)\equiv 3x^2+3x+3
$$

和：
$$
R(x)\equiv x^2+2x+1 \pmod 7
$$

---

#### $O(x)=\sum_i c_i\,o_i(x)$
$$
O(x)=5(3x^2+6x+5)+5(6x^2+3x+5)+6(5x^2+5x+5)
$$

各スカラー倍：
$$
4(3x^2+6x+5)\equiv 5x^2+3x+6
$$
$$
2(6x^2+3x+5)\equiv 5x^2+6x+3
$$
$$
2(5x^2+5x+5)\equiv 3x^2+3x+3
$$

和：
$$
O(x)\equiv 6x^2+5x+5 \pmod 7
$$

---

### マスター多項式 $p(x)$
$$
p(x)=L(x)R(x)-O(x)
$$

計算：
$$
p(x)=(x^2+2x+1)(x^2+2x+1)-(6x^2+5x+5)\equiv x^4+4x^3+6x+3 \pmod 7
$$

---

### 消失多項式 $V(x)$ と商多項式 $q(x)$

消失多項式：
$$
V(x)=(x-1)(x-2)(x-4)\equiv x^3+6 \pmod 7
$$

商多項式：
$$
p(x)=V(x)\,q(x),\qquad q(x)=x+4 \pmod 7
$$

---

## 3. Linear PCPベースのSNARKとGroth16がどのような安全性仮定に基づいているか説明してください。(ヒント: Generic Group Model, KoE Assumption)

### Linear PCPベースのSNARK
Generic Group Model (GGM) に基づいている。GGMとは、攻撃者が群の具体的な構造を理解できず、群演算（加算・乗算）だけをに利用できると仮定するモデル．直感的には、楕円曲線暗号で点の座標そのものを知ることはできず、群としての演算だけを扱える状況に近いそう。
そのため、攻撃者は群要素の「中身」を逆算して偽造することができず、与えられた演算の範囲内でしか行動できないため、安全性が保証される。

### Groth16
Groth16は，Knowledge of Exponent（KoE）仮定に依拠しており，指数関係を正しく構成できるならば，その指数自体を知っているとみなすという前提に立つ．この仮定により，指数の知識を持たない攻撃者が有効な証明を偽造することはできない．なぜなら、正しい証明を構成するには公開された要素 $g, g^x$ からさらに指数 $x$ に基づく関係式を生成する必要があり，その過程では実際に $x$ を知っていなければ不可能だから．
